/*! For license information please see woop.min.js.LICENSE.txt */
var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{Z:()=>Ge});var o=1,n=2,i=3,r=4,s=5,a=6,l=7,u=8,c=9,_=10;function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function d(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==h(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===h(i)?i:String(i)),n)}var i}var p=function(){function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=Math.round(t),this.y=Math.round(o)}var t,o;return t=e,(o=[{key:"set_x",value:function(e){this.x=Math.round(e)}},{key:"set_y",value:function(e){this.y=Math.round(e)}},{key:"clone",value:function(){return new e(this.x,this.y)}}])&&d(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function y(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==f(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===f(i)?i:String(i)),n)}var i}var g=function(){function e(t,o,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=Math.round(t),this.y=Math.round(o),this.z=Math.round(n)}var t,o;return t=e,(o=[{key:"set_x",value:function(e){this.x=Math.round(e)}},{key:"set_y",value:function(e){this.y=Math.round(e)}},{key:"set_z",value:function(e){this.x=Math.round(e)}}])&&y(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function m(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function b(e,t,o){return(t=w(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function w(e){var t=function(e,t){if("object"!==v(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===v(t)?t:String(t)}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,o;return t=e,o=[{key:"distance",value:function(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}}],null&&m(t.prototype,null),o&&m(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function S(e,t,o){return(t=P(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function T(e,t,o){return t&&j(e.prototype,t),o&&j(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function P(e){var t=function(e,t){if("object"!==k(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===k(t)?t:String(t)}b(x,"is_init",!1),b(x,"lookup_tables",{cos:[],sin:[],x_to_angle:[]}),b(x,"pi",Math.PI),b(x,"pi2",2*x.pi),b(x,"piRad",x.pi/180),b(x,"piDeg",180/x.pi),b(x,"min_scale",.00390625),b(x,"max_scale",64),b(x,"init",(function(e){for(var t=0;t<360;t++)x.lookup_tables.cos[t]=Math.cos(t*x.piRad),x.lookup_tables.sin[t]=Math.sin(t*x.piRad);for(var o=0;o<e.internal_width;o++)x.lookup_tables.x_to_angle[o]=x.radians_to_degrees(Math.atan((e.demi_internal_width-o)/e.screen_distance));x.is_init=!0})),b(x,"lookup_x_to_angle",(function(e){return x.is_init?x.lookup_tables.x_to_angle[e]:(console.log("WoopMath need to be init ( after the renderer ) for assessing the lookup table function"),null)})),b(x,"lookup_cos",(function(e){return x.is_init?x.lookup_tables.cos[x.angle_range(e)]:(console.log("WoopMath need to be init for assessing the lookup table function"),null)})),b(x,"lookup_sin",(function(e){return x.is_init?x.lookup_tables.sin[x.angle_range(e)]:(console.log("WoopMath need to be init for assessing the lookup table function"),null)})),b(x,"scale",(function(e,t,o,n,i){var r=x.lookup_x_to_angle(e),s=n*Math.cos(x.degrees_to_radians(t-r-i))/(o*Math.cos(x.degrees_to_radians(r)));return Math.min(Math.max(s,x.min_scale),x.max_scale)})),b(x,"angle_range",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:360;return arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?(e>o&&(e=o),e<t&&(e=t)):e=(e%=o)<t?e+o:e,arguments.length>4&&void 0!==arguments[4]&&!arguments[4]?e:Math.round(e)})),b(x,"value_range",(function(e,t,o){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){if(e>o)return t+e%o;if(e>t)return o-e%o}return Math.min(Math.max(e,t),o)})),b(x,"random_int_range",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)})),b(x,"point_to_angle",(function(e,t){var o=t.y-e.y,n=t.x-e.x;return x.angle_range(x.radians_to_degrees(Math.atan2(o,n)),0,360,!0,!1)})),b(x,"radians_to_degrees",(function(e){return e*x.piDeg})),b(x,"degrees_to_radians",(function(e){return e*x.piRad})),b(x,"binary_angle_to_degree",(function(e){return x.angle_range(360/65535*(e+32768),0,360,!0,!1)})),b(x,"angle_to_screen_x",(function(e,t,o){return e>=0?Math.round(t-Math.tan(x.degrees_to_radians(e))*o):Math.round(-1*Math.tan(x.degrees_to_radians(e))*o+t)}));var E=function(){function e(t,o){M(this,e),this.woop=t,this.nodes=o,this.root=o[o.length-1]}return T(e,[{key:"render_nodes",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!1},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.root;o()||(n instanceof D?t(n):this.is_right(e,n)?(this.render_nodes(e,t,o,n.right),this.check_bound_box(e,n.left_bound_box)&&this.render_nodes(e,t,o,n.left)):(this.render_nodes(e,t,o,n.left),this.check_bound_box(e,n.right_bound_box)&&this.render_nodes(e,t,o,n.right)))}},{key:"is_right",value:function(e,t){var o=e.position.x-t.partition_line.start.x,n=e.position.y-t.partition_line.start.y;return o*t.partition_line.y_direction-n*t.partition_line.x_direction>=0}},{key:"check_bound_box",value:function(e,t){var o=t.top_left.x,n=t.bottom_right.x,i=t.top_left.y,r=t.bottom_right.y,s=new p(o,r),a=new p(o,i),l=new p(n,i),u=new p(n,r),c=[];if(e.position.x<o)c=e.position.y>i?[[a,s],[l,a]]:e.position.y<r?[[a,s],[s,u]]:[[a,s]];else if(e.position.x>n)c=e.position.y>i?[[l,a],[u,l]]:e.position.y<r?[[s,u],[u,l]]:[[u,l]];else if(e.position.y>i)c=[[l,a]];else{if(!(e.position.y<r))return!0;c=[[s,u]]}for(var _=0;_<c.length;_++){var h=x.angle_range(x.point_to_angle(e.position,c[_][0]),0,360,!0,!1),d=x.angle_range(x.point_to_angle(e.position,c[_][1]),0,360,!0,!1),f=x.angle_range(h-d,0,360,!0,!1);if(x.angle_range(h-e.horizontal_angle+this.woop.renderer.demi_horisontal_fov,0,360,!0,!1)<this.woop.renderer.horisontal_fov+f)return!0}return!1}}]),e}(),z=T((function e(t,o,n,i,r,s){M(this,e),this.id=t,this.right=o,this.left=n,this.right_bound_box=i,this.left_bound_box=r,this.partition_line=s})),L=T((function e(t,o){M(this,e),this.top_left=t,this.bottom_right=o})),O=T((function e(t,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;M(this,e),this.start=t,this.end=o,this.x_direction=null!==n?n:o.x-t.x,this.y_direction=null!==i?i:o.y-t.y})),D=T((function e(t,o){M(this,e),this.id=t,this.segments=o})),A=T((function e(t,o,n,i,r,s){M(this,e),this.id=t,this.vertices=[o,n],this.angle=i,this.offset=r,this.edge=s})),C=T((function e(t,o,n,i,r,s){var a=this,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};M(this,e),S(this,"set_direction",(function(e){a.direction!==e&&[0,1].includes(e)&&(a.direction=e,a.right=[a.left,a.left=a.right][0])})),S(this,"set_angle",(function(e){a.angle=x.angle_range(e,0,360,!0,!1)})),this.vertices=[t,o],this.direction=n,this.angle=i,this.right=r,this.left=s,this.attributes=l})),I=T((function e(t,o,n,i,r,s){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};M(this,e),this.offset=t,this.sector=o,this.light=n,this.textures={up:i,middle:r,low:s},this.attributes=a})),H=T((function e(t,o,n,i,r,s,a){M(this,e),this.id=t,this.celling={height:o,texture:i,light:s},this.floor={height:n,texture:r,light:a}}));function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function W(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?B(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function G(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==R(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===R(i)?i:String(i)),n)}var i}var N=function(){function e(t,o,n,i,r,s,a,l,u,c,_){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.woop=t,this.cache=[],this.things=o,this.linedefs=n,this.sidedef=i,this.vertices=r,this.segs=s,this.ssectors=a,this.nodes=l,this.sectors=u,this.reject=c,this.blockmap=_}var t,o;return t=e,(o=[{key:"get_boundary",value:function(){if(void 0!==this.cache.boundary)return this.cache.boundary;var e=W(this.vertices[0]),t=W(this.vertices[0]);return this.vertices.forEach((function(o){o[0]<e[0]&&(e[0]=o[0]),o[1]>e[1]&&(e[1]=o[1]),o[0]>t[0]&&(t[0]=o[0]),o[1]<t[1]&&(t[1]=o[1])})),this.cache.boundary=[new p(e[0],e[1]),new p(t[0],t[1])],this.cache.boundary}},{key:"get_size",value:function(){if(void 0!==this.cache.size)return this.cache.size;var e=this.get_boundary();return this.cache.size=new p(e[0].x-e[1].x,e[0].y-e[1].y),this.cache.size}},{key:"get_player_start",value:function(){var e=this.get_things();return{position:new g(e[0].position.x,e[0].position.y,45),horizontal_angle:e[0].angle,vertical_angle:0}}},{key:"get_things",value:function(){if(void 0!==this.cache.things)return this.cache.things;this.cache.things=[];for(var e=0;e<this.things.length;e++)this.cache.things.push({position:new p(this.things[e][0],this.things[e][1]),angle:this.things[e][2],type:this.things[e][3],flags:this.things[e][4]});return this.cache.things}},{key:"get_bsp_tree",value:function(){if(void 0!==this.cache.nodes)return this.cache.nodes;var e=this.get_sub_sectors();this.cache.nodes=[];for(var t=0;t<this.nodes.length;t++)this.cache.nodes.push(new z(t,this.nodes[t][6]<0?e[32768+this.nodes[t][6]]:this.cache.nodes[this.nodes[t][6]],this.nodes[t][7]<0?e[32768+this.nodes[t][7]]:this.cache.nodes[this.nodes[t][7]],new L(new p(this.nodes[t][4][2],this.nodes[t][4][0]),new p(this.nodes[t][4][3],this.nodes[t][4][1])),new L(new p(this.nodes[t][5][2],this.nodes[t][5][0]),new p(this.nodes[t][5][3],this.nodes[t][5][1])),new O(new p(this.nodes[t][0],this.nodes[t][1]),new p(this.nodes[t][0]+this.nodes[t][2],this.nodes[t][1]+this.nodes[t][3]),this.nodes[t][2],this.nodes[t][3])));return new E(this.woop,this.cache.nodes)}},{key:"get_sub_sectors",value:function(){if(void 0!==this.cache.ssectors)return this.cache.ssectors;var e=this.get_segments();this.cache.ssectors=[];for(var t=0;t<this.ssectors.length;t++){for(var o=[],n=this.ssectors[t][1];n<this.ssectors[t][1]+this.ssectors[t][0];n++)o.push(e[n]);this.cache.ssectors.push(new D(t,o))}return this.cache.ssectors}},{key:"get_segments",value:function(){if(void 0!==this.cache.segs)return this.cache.segs;var e=this.get_vertices(),t=this.get_linedefs();this.cache.segs=[];for(var o=0;o<this.segs.length;o++)t[this.segs[o][3]].set_direction(this.segs[o][4]),t[this.segs[o][3]].set_angle(x.binary_angle_to_degree(this.segs[o][2])),this.cache.segs.push(new A(o,e[this.segs[o][0]],e[this.segs[o][1]],x.binary_angle_to_degree(this.segs[o][2]),this.segs[o][5],t[this.segs[o][3]]));return this.cache.segs}},{key:"get_vertices",value:function(){if(void 0!==this.cache.vertices)return this.cache.vertices;this.cache.vertices=[];for(var e=0;e<this.vertices.length;e++)this.cache.vertices.push(new p(this.vertices[e][0],this.vertices[e][1]));return this.cache.vertices}},{key:"get_linedefs",value:function(){if(void 0!==this.cache.linedefs)return this.cache.linedefs;var e=this.get_vertices(),t=this.get_sidedefs();this.cache.linedefs=[];for(var o=0;o<this.linedefs.length;o++){var n=-1!==this.linedefs[o][5]&&t[this.linedefs[o][5]],i=-1!==this.linedefs[o][6]&&t[this.linedefs[o][6]],r={doom_fag:this.linedefs[o][2],doom_special_type:this.linedefs[o][3],doom_sector_tag:this.linedefs[o][4],is_solid:n&&i,is_portal:!(n&&i)};this.cache.linedefs.push(new C(e[this.linedefs[o][0]],e[this.linedefs[o][1]],0,0,n,i,r))}return this.cache.linedefs}},{key:"get_sidedefs",value:function(){if(void 0!==this.cache.sidedef)return this.cache.sidedef;this.cache.sidedef=[];for(var e=this.get_sectors(),t=0;t<this.sidedef.length;t++)this.cache.sidedef.push(new I(new p(this.sidedef[t][0],this.sidedef[t][1]),e[this.sidedef[t][5]],e[this.sidedef[t][5]].celling.light,"-"!==this.sidedef[t][2]&&this.sidedef[t][2],"-"!==this.sidedef[t][4]&&this.sidedef[t][4],"-"!==this.sidedef[t][3]&&this.sidedef[t][3],{doom_special_type:this.sidedef[t][5],doom_tag_number:this.sidedef[t][6]}));return this.cache.sidedef}},{key:"get_sectors",value:function(){if(void 0!==this.cache.sectors)return this.cache.sectors;this.cache.sectors=[];for(var e=0;e<this.sectors.length;e++)this.cache.sectors.push(new H(e,this.sectors[e][1],this.sectors[e][0],"-"!==this.sectors[e][3]&&this.sectors[e][3],"-"!==this.sectors[e][2]&&this.sectors[e][2],this.sectors[e][4],this.sectors[e][4]));return this.cache.sectors}}])&&G(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function q(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==F(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===F(i)?i:String(i)),n)}var i}var U=function(){function e(t){var o=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.woop=t,this.cache=[],this.wads=[],this.lumps_count=0,this.lumps_directory=[],n.length>0&&n.forEach((function(e){o.add_wad(e)}))}var t,h;return t=e,h=[{key:"get_int8",value:function(e,t){return new Int8Array(e,t,1)[0]}},{key:"get_int16",value:function(e,t){return new Int16Array(e,t,1)[0]}},{key:"get_int32",value:function(e,t){return new Int32Array(e,t,1)[0]}},{key:"ascii_decoder",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o="",n=e.byteLength;if(n-t<1)return o;for(var i=t;i<n;i++){var r=e[i];if(r<=127)o+=String.fromCharCode(r);else if(r>=192&&r<224)o+=String.fromCharCode((31&r)<<6|63&e[i]);else if(r>=224&&r<240)o+=String.fromCharCode((15&r)<<12|(63&e[i])<<6|63&e[i]);else if(r>=240){var s=((7&r)<<18|(63&e[i])<<12|(63&e[i])<<6|63&e[i])-65536;o+=String.fromCharCode(55296+(s>>10)),o+=String.fromCharCode(56320+(1023&s))}}return o}},{key:"read_bytes",value:function(e,t,o,n){switch(n){case"int8":return this.get_int8(e,t);case"int16":return this.get_int16(e,t);case"int16[4]":return[this.get_int16(e,t),this.get_int16(e,t+2),this.get_int16(e,t+4),this.get_int16(e,t+6)];case"int32":return this.get_int32(e,t,4);default:return new Uint8Array(e,t,o)}}},{key:"read_1_byte",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"int8";return this.read_bytes(e,t,1,o)}},{key:"read_2_bytes",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"int16";return this.read_bytes(e,t,2,o)}},{key:"read_4_bytes",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"int32";return this.read_bytes(e,t,4,o)}},{key:"read_8_bytes",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"int16[4]";return this.read_bytes(e,t,8,o)}},{key:"read_string",value:function(e,t,o){var n=this.read_bytes(e,t,o);return this.ascii_decoder(n).replace(/\x00*/g,"")}},{key:"add_wad",value:function(e){var t=new XMLHttpRequest;if(t.open("GET",e,!1),t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(),200==t.status){console.log("adding "+e);var o=this.wads.length,n=Uint8Array.from(t.response,(function(e){return e.charCodeAt(0)})).buffer,i={header:{type:this.read_string(n,0,4),lump_count:this.read_4_bytes(n,4),init_offset:this.read_4_bytes(n,8)},file_buffer:n};if("IWAD"==i.header.type||"PWAD"==i.header.type){this.wads.push(i);var r=i.header.init_offset;this.lumps_count+=i.header.lump_count;for(var s=0;s<i.header.lump_count;s++){var a={};a.wad=o,a.offset=this.read_4_bytes(n,r),a.size=this.read_4_bytes(n,r+4),a.name=this.read_string(n,r+8,8),r+=16,this.lumps_directory.push(a)}}else console.log("Wad file "+e+" doesn't have IWAD or PWAD id")}else console.log("couldn't open "+e)}},{key:"get_lump_index_by_name",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.lumps_count;o--;o>=0)if(this.lumps_directory[o].name==e)return t&&console.log("lump "+e+" found at index '"+o+"' !"),o;return console.log("Lump "+e+" not found!"),-1}},{key:"get_lumps_indexes_by_name",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[],n=0;n<this.lumps_count;n++){var i=e.indexOf(this.lumps_directory[n].name);-1!=i&&(t&&console.log("lump "+e[i]+" found at index '"+n+"' !"),o.push(n))}return 0===o.length&&t&&console.log("Lumps not found !"),o}},{key:"get_map_data",value:function(e){var t=this.get_lump_index_by_name(e);return-1===t?null:new N(this.woop,this.read_things_from_lump(t),this.read_lindefs_from_lump(t),this.read_sidedef_from_lump(t),this.read_vertices_from_lump(t),this.read_segs_from_lump(t),this.read_ssectors_from_lump(t),this.read_nodes_from_lump(t),this.read_sectors_from_lump(t),this.read_reject_from_lump(t),this.read_blockmap_from_lump(t))}},{key:"read_things_from_lump",value:function(e){for(var t=this.cache_lump(e+o),n=[],i=0;i<t.byteLength;i+=10)n.push([this.read_2_bytes(t,i+0,"int16"),this.read_2_bytes(t,i+2,"int16"),this.read_2_bytes(t,i+4,"int16"),this.read_2_bytes(t,i+6,"int16"),this.read_2_bytes(t,i+8,"int16")]);return n}},{key:"read_vertices_from_lump",value:function(e){for(var t=this.cache_lump(e+r),o=[],n=0;n<t.byteLength;n+=4)o.push([this.read_2_bytes(t,n+0,"int16"),this.read_2_bytes(t,n+2,"int16")]);return o}},{key:"read_nodes_from_lump",value:function(e){for(var t=this.cache_lump(e+l),o=[],n=0;n<t.byteLength;n+=28)o.push([this.read_2_bytes(t,n+0,"int16"),this.read_2_bytes(t,n+2,"int16"),this.read_2_bytes(t,n+4,"int16"),this.read_2_bytes(t,n+6,"int16"),this.read_8_bytes(t,n+8,"int16[4]"),this.read_8_bytes(t,n+16,"int16[4]"),this.read_2_bytes(t,n+24,"int16"),this.read_2_bytes(t,n+26,"int16")]);return o}},{key:"read_ssectors_from_lump",value:function(e){for(var t=this.cache_lump(e+a),o=[],n=0;n<t.byteLength;n+=4)o.push([this.read_2_bytes(t,n+0,"int16"),this.read_2_bytes(t,n+2,"int16")]);return o}},{key:"read_segs_from_lump",value:function(e){for(var t=this.cache_lump(e+s),o=[],n=0;n<t.byteLength;n+=12)o.push([this.read_2_bytes(t,n+0,"int16"),this.read_2_bytes(t,n+2,"int16"),this.read_2_bytes(t,n+4,"int16"),this.read_2_bytes(t,n+6,"int16"),this.read_2_bytes(t,n+8,"int16"),this.read_2_bytes(t,n+10,"int16")]);return o}},{key:"read_lindefs_from_lump",value:function(e){for(var t=this.cache_lump(e+n),o=[],i=0;i<t.byteLength;i+=14)o.push([this.read_2_bytes(t,i+0,"int16"),this.read_2_bytes(t,i+2,"int16"),this.read_2_bytes(t,i+4,"int16"),this.read_2_bytes(t,i+6,"int16"),this.read_2_bytes(t,i+8,"int16"),this.read_2_bytes(t,i+10,"int16"),this.read_2_bytes(t,i+12,"int16")]);return o}},{key:"read_sidedef_from_lump",value:function(e){for(var t=this.cache_lump(e+i),o=[],n=0;n<t.byteLength;n+=30)o.push([this.read_2_bytes(t,n+0,"int16"),this.read_2_bytes(t,n+2,"int16"),this.read_string(t,n+4,8),this.read_string(t,n+12,8),this.read_string(t,n+20,8),this.read_2_bytes(t,n+28,"int16")]);return o}},{key:"read_sectors_from_lump",value:function(e){for(var t=this.cache_lump(e+u),o=[],n=0;n<t.byteLength;n+=26)o.push([this.read_2_bytes(t,n+0,"int16"),this.read_2_bytes(t,n+2,"int16"),this.read_string(t,n+4,8),this.read_string(t,n+12,8),this.read_2_bytes(t,n+20,"int16"),this.read_2_bytes(t,n+22,"int16"),this.read_2_bytes(t,n+24,"int16")]);return o}},{key:"read_reject_from_lump",value:function(e){return this.cache_lump(e+c)}},{key:"read_blockmap_from_lump",value:function(e){return this.cache_lump(e+_)}},{key:"cache_lump",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e>=this.lumps_count&&t&&console("lump index is out of range !");var o=this.lumps_directory[e].wad;return void 0===this.cache[o]&&(this.cache[o]=[]),this.cache[o][e]||(this.cache[o][e]=this.wads[o].file_buffer.slice(this.lumps_directory[e].offset,this.lumps_directory[e].offset+this.lumps_directory[e].size)),this.cache[o][e]}}],h&&q(t.prototype,h),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function V(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Y(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Y(i)?i:String(i)),n)}var i}function X(e,t,o){return t&&V(e.prototype,t),o&&V(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}var Z=X((function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.position=t,this.horizontal_angle=o,this.vertical_angle=n}));function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function J(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==$(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===$(i)?i:String(i)),n)}var i}var K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.woop=t,this.name="void",this.vertices=[],this.segments=[],this.size=new p(1,1),this.bsp_tree=null,this.boundary=[new p(0,0),new p(1,1)],this.player_start={position:new g(1,1,45),horizontal_angle:0,vertical_angle:0}}var t,o;return t=e,(o=[{key:"load_from_wad",value:function(e,t){var o=e.get_map_data(t);this.name=t,this.size=o.get_size(),this.boundary=o.get_boundary(),this.bsp_tree=o.get_bsp_tree(),this.player_start=o.get_player_start(),this.vertices=o.get_vertices(),this.segments=o.get_segments()}},{key:"spawn_player",value:function(){return new Z(this.player_start.position,this.player_start.horizontal_angle,this.player_start.vertical_angle)}}])&&J(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function ee(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ne(n.key),n)}}function te(e,t,o){return t&&ee(e.prototype,t),o&&ee(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function oe(e,t,o){return(t=ne(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ne(e){var t=function(e,t){if("object"!==Q(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Q(t)?t:String(t)}var ie=te((function e(t,o){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),oe(this,"init",(function(){n.screen=Array(n.width).fill().map((function(){return[0,Array(n.height).fill().map((function(){return 0}))]}))})),oe(this,"fill_pixel",(function(e,t){e=x.value_range(e,0,n.width-1),t=x.value_range(t,0,n.height-1),n.screen[e][1][t]=2,n.update_vertical_line(e)})),oe(this,"fill_vertical_line",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.height-1;if(e=x.value_range(e,0,n.width-1),t=x.value_range(t,0,n.height-1),o=x.value_range(o,0,n.height-1),0!==t||o!==n.height-1){for(var i=t;i<=o;i++)n.screen[e][1][i]=2;n.update_vertical_line(e)}else n.screen[e]=[2,Array(n.height).fill(2)]})),oe(this,"fill_horizontal_line",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.width-1;e=x.value_range(e,0,n.width-1),t=x.value_range(t,0,n.width-1);for(var o=e;o<=t;o++)n.screen[o]=[2,Array(n.height).fill(2)]})),oe(this,"get_empty_horizontal_range",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.width-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(![-1,1].includes(o))return console.log("get_empty_vertical_range : invalid direction"),e;if(e=x.value_range(e,0,n.width-1),t=x.value_range(t,0,n.width-1),n.vertical_is_full(e))return 0;for(;e!==t&&n.vertical_line_has_space(e);)e+=o;return e})),oe(this,"get_empty_vertical_range",(function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(![-1,1].includes(i))return console.log("get_empty_vertical_range : invalid direction"),t;if(e=x.value_range(e,0,n.width-1),t=x.value_range(t,0,n.height-1),o=x.value_range(o,0,n.height-1),n.pixel_is_full(e,t))return 0;for(;t!==o+i&&n.pixel_is_full(e,t);)t+=i;return t})),oe(this,"has_space",(function(){for(var e=0;e<n.width;e++)if(2!==n.screen[e][0])return!0;return!1})),oe(this,"is_full",(function(){return!n.has_space()})),oe(this,"horizontal_line_has_space",(function(e,t){for(var o=x.value_range(Math.min(e,t),0,n.width-1),i=x.value_range(Math.min(e,t),0,n.width-1),r=o;r<=i;r++)if(2!==n.screen[r][0])return!0;return!1})),oe(this,"horizontal_line_is_full",(function(e,t){return!n.horizontal_line_has_space(e,t)})),oe(this,"vertical_line_has_space",(function(e){return e=x.value_range(e,0,n.width-1),2!==n.screen[e][0]})),oe(this,"vertical_is_full",(function(e){return!n.vertical_line_has_space(e)})),oe(this,"update_vertical_line",(function(e){e=x.value_range(e,0,n.width-1),n.screen[e][1].includes(0)?n.screen[e][1].includes(1)?n.screen[e][0]=1:n.screen[e][0]=0:n.screen[e][0]=2})),oe(this,"pixel_has_space",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.width-1;return e=x.value_range(e,0,n.width-1),t=x.value_range(t,0,n.height-1),0===n.screen[e][1][t]})),oe(this,"pixel_is_full",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.width-1;return!n.pixel_has_space(e,t)})),this.screen=null,this.width=t,this.height=o,this.init()}));function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function se(e,t){if(e){if("string"==typeof e)return ae(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ae(e,t):void 0}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function le(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ce(n.key),n)}}function ue(e,t,o){return(t=ce(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ce(e){var t=function(e,t){if("object"!==re(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===re(t)?t:String(t)}var _e=function(){function e(t,o,n,i,r){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ue(this,"resize",(function(){s.canvas.width=window.visualViewport.width,s.canvas.height=window.visualViewport.height,s.internal_width=Math.round(s.canvas.width/s.pixel_scale),s.internal_height=Math.round(s.canvas.height/s.pixel_scale),s.demi_internal_width=s.internal_width/2,s.demi_internal_height=s.internal_height/2,s.horisontal_fov=s.fov,s.demi_horisontal_fov=s.horisontal_fov/2,s.screen_distance=s.demi_internal_width/Math.tan(x.degrees_to_radians(s.demi_horisontal_fov)),s.screen_space=new ie(s.internal_width,s.internal_height),x.init(s)})),ue(this,"update_render_variables",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};void 0===s.data_sets[e]&&(s.data_sets[e]={}),Object.entries(t).forEach((function(t){var o,n,i=(n=2,function(e){if(Array.isArray(e))return e}(o=t)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,i,r,s,a=[],l=!0,u=!1;try{if(r=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;l=!1}else for(;!(l=(n=r.call(o)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=o.return&&(s=o.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(o,n)||se(o,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=i[0],a=i[1];s.data_sets[e][r]=a}))})),ue(this,"get_from_data_sets",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common",t=arguments.length>1?arguments[1]:void 0;return void 0===s.data_sets[e]||void 0===s.data_sets[e][t]?null:s.data_sets[e][t]})),ue(this,"draw",(function(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"function"==typeof s["draw_"+e+"_"+s.render_mode]?s["draw_"+e+"_"+s.render_mode].apply(s,function(e){if(Array.isArray(e))return ae(e)}(t=o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||se(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):console.log("no "+s.render_mode+" draw_"+e+" function.")})),ue(this,"draw_background",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"background";s.draw("background",[e])})),ue(this,"draw_text",(function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"white",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6;s.draw("text",[e,t,o,n,i])})),ue(this,"draw_cursor",(function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"white",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;s.draw("cursor",[e,t,o,n,i])})),ue(this,"draw_editor_grid",(function(){s.draw("editor_grid",[])})),ue(this,"draw_editor_player",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.woop.player,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red";s.draw("editor_player",[e,t])})),ue(this,"draw_editor_bound_box",(function(e){s.draw("editor_bound_box",[e])})),ue(this,"draw_editor_sub_sector",(function(e){s.draw("editor_sub_sector",[e])})),ue(this,"draw_bsp_nodes",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.woop.level.bsp_tree.root;s.draw("editor_bsp_nodes",[e])})),ue(this,"draw_editor_sector_in_field_of_view",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.woop.level.bsp_tree;s.draw("editor_sector_in_field_of_view",[e])})),ue(this,"draw_game_pixel",(function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;s.draw("game_pixel",[e,t,o,n])})),ue(this,"draw_game_line",(function(e,t,o,n,i,r){s.draw("game_line",[e,t,o,n,i,r])})),ue(this,"draw_game_vertical_line",(function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:50;s.draw("game_vertical_line",[e,t,o,n,i])})),ue(this,"draw_game_edge",(function(e,t,o,n,i,r){s.draw("game_edge",[e,t,o,n,i,r])})),ue(this,"draw_game_sector_in_field_of_view",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.woop.level.bsp_tree;s.draw("game_sector_in_field_of_view",[e])})),ue(this,"draw_game_sub_sector",(function(e){s.draw("game_sub_sector",[e])})),this.woop=t,this.canvas=o,this.render_mode=n,this.fov=i,this.pixel_scale=r,this.data_sets={},this.screen_space=null,this.colors={black:[33,33,33],"blacker black":[0,0,0],white:[255,255,255],"lite grey":[210,210,210],grey:[150,150,150],"dark grey":[100,100,100],yellow:[255,255,0],"dark yellow":[160,160,0],green:[0,255,0],"dark green":[0,160,0],cyan:[0,255,255],"dark cyan":[0,160,160],red:[200,0,0],"dark red":[150,0,0],blue:[0,0,200],"dark blue":[0,0,130],brown:[160,100,0],"dark brown":[110,50,0],background:[0,60,130]},this.render_mode,this.context=o.getContext("2d"),this.init_listener(),this.resize()}var t,o;return t=e,o=[{key:"init_listener",value:function(){var e=this;window.addEventListener("resize",(function(){e.resize()}))}},{key:"add_color",value:function(e,t,o,n){void 0===this.colors[e]&&(this.colors[e]=[x.value_range(t,0,255),x.value_range(o,0,255),x.value_range(n,0,255)])}},{key:"get_color",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=x.value_range(t,0,1);void 0===this.colors[e]&&this.add_color(e,x.random_int_range(100,255),x.random_int_range(100,255),x.random_int_range(100,255));var i=this.colors[e];return 1===n?o?"rgb("+i[0]+","+i[1]+","+i[2]+" )":i:o?"rgba("+i[0]+","+i[1]+","+i[2]+","+n+" )":i}},{key:"draw_editor_point",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"grey",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dark grey",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2;this.draw("editor_point",[e,t,o,n,i,r,s,a])}},{key:"draw_editor_line",value:function(e,t,o,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dark grey",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2;this.draw("editor_line",[e,t,o,n,i,r,s])}},{key:"draw_editor_box",value:function(e,t,o,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"green",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2;this.draw("editor_box",[e,t,o,n,i,r,s])}}],o&&le(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function de(e,t){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},de(e,t)}function pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fe(e)}function ye(e,t,o){return(t=ge(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ge(e){var t=function(e,t){if("object"!==he(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==he(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===he(t)?t:String(t)}var ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&de(e,t)}(r,_e);var t,o,n,i=(o=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fe(o);if(n){var i=fe(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pe(e)}(this,e)});function r(e,t,o,n){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),ye(pe(s=i.call(this,e,t,"2D",o,n)),"draw_background_2D",(function(e){s.context.fillStyle=s.get_color(e,1,!0),s.context.fillRect(0,0,s.canvas.width,s.canvas.height)})),ye(pe(s),"draw_cursor_2D",(function(e,t,o,n,i){switch(s.context.strokeStyle=s.context.fillStyle=s.get_color(n,i,!0),s.context.fillStyle=s.context.fillStyle=s.get_color(n,i,!0),s.context.beginPath(),o){case 0:s.context.moveTo(e,t),s.context.lineTo(e+16,t+6),s.context.lineTo(e+6,t+16);break;case 1:s.context.moveTo(e,t-8),s.context.lineTo(e,t+8),s.context.moveTo(e-8,t),s.context.lineTo(e+8,t)}s.context.stroke(),s.context.fill()})),ye(pe(s),"draw_editor_point_2D",(function(e,t,o,n,i,r,a,l){var u=s.get_from_data_sets("editor","pixel_x_offset"),c=s.get_from_data_sets("editor","pixel_y_offset"),_=s.get_from_data_sets("editor","grid_scale");s.context.strokeStyle=s.get_color(o,n,!0),s.context.fillStyle=s.get_color(i,r,!0),s.context.lineWidth=l,s.context.beginPath(),s.context.arc(e*_-u,-1*t*_-c,a,0,x.pi2),s.context.stroke(),s.context.fill()})),ye(pe(s),"draw_editor_line_2D",(function(e,t,o,n,i,r,a){var l=s.get_from_data_sets("editor","pixel_x_offset"),u=s.get_from_data_sets("editor","pixel_y_offset"),c=s.get_from_data_sets("editor","grid_scale");s.context.beginPath(),s.context.fillStyle="rgba( 0, 0, 0, 0 )",s.context.strokeStyle=s.get_color(i,r,!0),s.context.lineWidth=a,s.context.moveTo(e*c-l,-1*t*c-u),s.context.lineTo(o*c-l,-1*n*c-u),s.context.stroke()})),ye(pe(s),"draw_editor_box_2D",(function(e,t,o,n,i,r,a){var l=s.get_from_data_sets("editor","pixel_x_offset"),u=s.get_from_data_sets("editor","pixel_y_offset"),c=s.get_from_data_sets("editor","grid_scale");s.context.fillStyle="rgba( 0, 0, 0, 0 )",s.context.strokeStyle=s.get_color(i,r,!0),s.context.lineWidth=a,s.context.strokeRect(e*c-l,-1*t*c-u,o*c-l-(e*c-l),-1*n*c-u-(-1*t*c-u))})),ye(pe(s),"draw_text_2D",(function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"white",i=arguments.length>4?arguments[4]:void 0;s.context.fillStyle=s.get_color(n,1,!0),s.context.font=i.toString()+"px Arial",s.context.fillText(o,e,t)})),ye(pe(s),"draw_editor_player_2D",(function(e,t){var o=s.get_from_data_sets("editor","pixel_x_offset"),n=s.get_from_data_sets("editor","pixel_y_offset"),i=s.get_from_data_sets("editor","grid_scale"),r=s.woop.player.position.x*i-o,a=-1*s.woop.player.position.y*i-n,l=x.angle_range(-1*s.woop.player.horizontal_angle),u=x.angle_range(-1*s.woop.player.horizontal_angle+s.horisontal_fov/2),c=x.angle_range(-1*s.woop.player.horizontal_angle-s.horisontal_fov/2);s.draw_editor_point_2D(s.woop.player.position.x,s.woop.player.position.y,t,1,t,.5,4,1),s.context.beginPath(),s.context.lineWidth=4,s.context.strokeStyle=s.get_color(t,1,!0),s.context.fillStyle=s.get_color(t,.5,!0),s.context.moveTo(Math.round(r+4*x.lookup_cos(l)),Math.round(a+4*x.lookup_sin(l))),s.context.lineTo(Math.round(r+20*x.lookup_cos(l)),Math.round(a+20*x.lookup_sin(l))),s.context.stroke(),s.context.lineWidth=1,s.context.strokeStyle=s.get_color("green",1,!0),s.context.fillStyle=s.get_color("green",.5,!0),s.context.beginPath(),s.context.moveTo(Math.round(r+4*x.lookup_cos(u)),Math.round(a+4*x.lookup_sin(u))),s.context.lineTo(Math.round(r+500*x.lookup_cos(u)),Math.round(a+500*x.lookup_sin(u))),s.context.stroke(),s.context.beginPath(),s.context.strokeStyle=s.get_color("green",1,!0),s.context.fillStyle=s.get_color("green",.5,!0),s.context.moveTo(Math.round(r+4*x.lookup_cos(c)),Math.round(a+4*x.lookup_sin(c))),s.context.lineTo(Math.round(r+500*x.lookup_cos(c)),Math.round(a+500*x.lookup_sin(c))),s.context.stroke()})),ye(pe(s),"draw_editor_grid_2D",(function(){var e=s.get_from_data_sets("editor","pixel_x_offset"),t=s.get_from_data_sets("editor","pixel_y_offset"),o=Math.ceil(s.canvas.width/s.woop.editor.ceil_pixel_size()),n=Math.ceil(s.canvas.height/s.woop.editor.ceil_pixel_size()),i=s.woop.editor.grid_pos.x,r=-1*s.woop.editor.grid_pos.y,a=e%s.woop.editor.ceil_pixel_size(),l=t%s.woop.editor.ceil_pixel_size(),u=Math.floor(i/s.woop.editor.unit_by_ceil),c=-1*Math.floor(r/s.woop.editor.unit_by_ceil),_=[];s.context.beginPath(),s.context.strokeStyle="rgba( 120, 120, 120, 1 )",s.context.fillStyle="rgba( 255, 255, 255, 1 )",s.context.lineWidth=1,s.context.font="6px ARIAL",s.context.fillText("x",30,20),s.context.fillText("y",20,30);for(var h=0;h<=o;h++)h>1&&s.context.fillText((h+u)*s.woop.editor.unit_by_ceil,h*s.woop.editor.ceil_pixel_size()-a,20),0!==Math.ceil((h+u)*s.woop.editor.unit_by_ceil)?(s.context.moveTo(h*s.woop.editor.ceil_pixel_size()-a,0),s.context.lineTo(h*s.woop.editor.ceil_pixel_size()-a,s.canvas.height)):_.push([h*s.woop.editor.ceil_pixel_size()-a,0,h*s.woop.editor.ceil_pixel_size()-a,s.canvas.height]);for(var d=0;d<=n;d++)d>1&&s.context.fillText((-1*d+c)*s.woop.editor.unit_by_ceil,20,d*s.woop.editor.ceil_pixel_size()-l),0!==Math.ceil((-1*d+c)*s.woop.editor.unit_by_ceil)?(s.context.moveTo(0,d*s.woop.editor.ceil_pixel_size()-l),s.context.lineTo(s.canvas.width,d*s.woop.editor.ceil_pixel_size()-l)):_.push([0,d*s.woop.editor.ceil_pixel_size()-l,s.canvas.width,d*s.woop.editor.ceil_pixel_size()-l]);s.context.stroke(),_.length>0&&(s.context.beginPath(),s.context.lineWidth=2,s.context.strokeStyle="rgba( 120, 0 , 0, 1 )",_.forEach((function(e){s.context.moveTo(e[0],e[1]),s.context.lineTo(e[2],e[3])})),s.context.stroke())})),ye(pe(s),"draw_editor_sector_in_field_of_view_2D",(function(e){e.render_nodes(s.woop.player,s.draw_editor_sub_sector_2D)})),ye(pe(s),"draw_bsp_node_2D",(function(e){s.draw_editor_box_2D(e.right_bound_box.top_left.x,e.right_bound_box.top_left.y,e.right_bound_box.bottom_right.x,e.right_bound_box.bottom_right.y,"dark green",.5,2),s.draw_editor_box_2D(e.left_bound_box.top_left.x,e.left_bound_box.top_left.y,e.left_bound_box.bottom_right.x,e.left_bound_box.bottom_right.y,"dark red",.5,2),s.draw_editor_line_2D(e.partition_line.start.x,e.partition_line.start.y,e.partition_line.end.x,e.partition_line.end.y,"dark yellow",1,2)})),ye(pe(s),"draw_editor_bound_box_2D",(function(e){s.draw_editor_box_2D(e.top_left.x,e.top_left.y,e.bottom_right.x,e.bottom_right.y,"dark green",.5,2)})),ye(pe(s),"draw_editor_sub_sector_2D",(function(e){for(var t=0;t<e.segments.length;t++){var o=x.point_to_angle(s.woop.player.position,e.segments[t].edge.vertices[0]),n=x.point_to_angle(s.woop.player.position,e.segments[t].edge.vertices[1]),i=x.angle_range(o-n,0,360,!0,!1);if(!(i>180)){var r=o-s.woop.player.horizontal_angle;if(!(x.angle_range(r+s.woop.renderer.demi_horisontal_fov,0,360,!0,!1)>i+s.woop.renderer.horisontal_fov)){var a=n-s.woop.player.horizontal_angle;x.angle_range(s.woop.renderer.demi_horisontal_fov-a,0,360,!0,!1)>i+s.woop.renderer.horisontal_fov||(s.add_color(e.id,x.random_int_range(100,255),x.random_int_range(100,255),x.random_int_range(100,255)),s.draw_editor_line(e.segments[t].edge.vertices[0].x,e.segments[t].edge.vertices[0].y,e.segments[t].edge.vertices[1].x,e.segments[t].edge.vertices[1].y,e.id,1,4))}}}})),ye(pe(s),"draw_game_pixel_2D",(function(e,t,o,n){e<0||e>s.internal_width-1||t<0||t>s.internal_height-1||(s.context.fillStyle=s.get_color(o,1,!0),s.context.fillRect(e*s.pixel_scale,t*s.pixel_scale,s.pixel_scale,s.pixel_scale))})),ye(pe(s),"draw_game_vertical_line_2D",(function(e,t,o,n,i){if(!(e<0||e>s.internal_width))for(var r=t;r<=o;r++)if(!(r<0||r>s.internal_height)&&s.screen_space.pixel_has_space(e,r)){var a=n;s.draw_game_pixel(e,r,a,1),s.screen_space.fill_pixel(e,r)}})),ye(pe(s),"draw_game_edge_2D",(function(e,t,o,n,i,r){var a=e.edge.attributes.is_solid,l=e.edge.right,u=e.edge.left,c=l.sector,_=!!u&&u.sector,h=l.textures.upper,d=l.textures.middle,p=l.textures.low,f=c.celling.texture,y=c.floor.texture,g=(l.light,c.floor.light,c.celling.light,c.celling.height-s.woop.player.position.z),v=c.floor.height-s.woop.player.position.z,m=_?_.celling.height-s.woop.player.position.z:g,b=_?_.floor.height-s.woop.player.position.z:v;a||g===m||g>=0?h=!1:g>m&&(m=[g,g=m][0],h=u.textures.upper),(a||v===b||v<=0)&&(p=!1);var w=!1!==h,k=!1!==d,S=!1!==p,M=!1!==f,j=!1!==y;if(w||k||S||M||j){[292].includes(e.id)&&console.log({is_solid:a,display:{upper_edge_is_draw:w,middle_edge_is_draw:k,lower_edge_is_draw:S,celling_is_draw:M,floor_is_draw:j}});for(var T=e.edge.angle+90,P=T-t,E=x.distance(s.woop.player.position,e.edge.vertices[0])*Math.cos(x.degrees_to_radians(P)),z=x.scale(o,T,E,s.screen_distance,s.woop.player.horizontal_angle),L=(x.scale(n,T,E,s.screen_distance,s.woop.player.horizontal_angle)-z)/(n-o),O=s.demi_internal_height-g*z,D=-L*g,A=s.demi_internal_height-m*z,C=-L*m,I=s.demi_internal_height-b*z,H=-L*b,R=s.demi_internal_height-v*z,W=-L*v,B=o;B<=n;B++)if(!(B<i||B>r)){var G=O+D*(B-o),N=A+C*(B-o),F=I+H*(B-o),q=R+W*(B-o);if(k){var U=w?N:G,Y=S&&q>F?F:q;s.draw_game_vertical_line(B,Math.round(U),Math.round(Y),d),s.screen_space.fill_vertical_line(B,Math.round(U),Math.round(Y))}w&&(s.draw_game_vertical_line(B,Math.round(G),Math.round(N),h),s.screen_space.fill_vertical_line(B,Math.round(G),Math.round(N))),S&&(s.draw_game_vertical_line(B,Math.round(F),Math.round(q),p),s.screen_space.fill_vertical_line(B,Math.round(F),Math.round(q)))}s.draw_text(o*s.pixel_scale,(A-20)*s.pixel_scale,e.id.toString(),h,18)}})),ye(pe(s),"draw_game_sector_in_field_of_view_2D",(function(e){s.screen_space.init(),e.render_nodes(s.woop.player,s.draw_game_sub_sector_2D,s.screen_space.is_full)})),ye(pe(s),"draw_game_sub_sector_2D",(function(e){for(var t=0;t<e.segments.length&&s.screen_space.has_space();t++){var o=x.point_to_angle(s.woop.player.position,e.segments[t].edge.vertices[0]),n=x.point_to_angle(s.woop.player.position,e.segments[t].edge.vertices[1]),i=x.angle_range(o-n,0,360,!0,!1);if(!(i>180)){var r=o-s.woop.player.horizontal_angle;if(!(x.angle_range(r+s.woop.renderer.demi_horisontal_fov,0,360,!0,!1)>=i+s.woop.renderer.horisontal_fov)){var a=n-s.woop.player.horizontal_angle;if(!(x.angle_range(s.woop.renderer.demi_horisontal_fov-a,0,360,!0,!1)>=i+s.woop.renderer.horisontal_fov)){var l=x.value_range(x.angle_to_screen_x(r,s.screen_distance,s.demi_internal_width),0,s.internal_width-1),u=x.value_range(x.angle_to_screen_x(a,s.screen_distance,s.demi_internal_width),0,s.internal_width-1);if(s.screen_space.horizontal_line_has_space(l,u))for(var c=l;c<=u;c++)if(s.screen_space.vertical_line_has_space(c)){var _=s.screen_space.get_empty_horizontal_range(c);s.draw_game_edge(e.segments[t],o,l,u,c,_),c=_}}}}}})),s}return t=r,Object.defineProperty(t,"prototype",{writable:!1}),t}();function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function be(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ke(n.key),n)}}function we(e,t,o){return t&&be(e.prototype,t),o&&be(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function xe(e,t,o){return(t=ke(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ke(e){var t=function(e,t){if("object"!==me(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===me(t)?t:String(t)}var Se=we((function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),xe(this,"update",(function(){o.woop.inputs.mouse_lock?o.woop.player.horizontal_angle-=Math.round(o.woop.inputs.mouse_movements.x/8):(o.woop.inputs.input_status.has("look_left_down")&&(o.woop.player.horizontal_angle+=2),o.woop.inputs.input_status.has("look_right_down")&&(o.woop.player.horizontal_angle-=2)),o.woop.player.horizontal_angle=x.angle_range(o.woop.player.horizontal_angle);var e=Math.round(6*x.lookup_sin(o.woop.player.horizontal_angle)),t=Math.round(6*x.lookup_cos(o.woop.player.horizontal_angle));o.woop.inputs.mouse_lock?o.woop.player.look_vertical-=Math.round(o.woop.inputs.mouse_movements.y/16):(o.woop.inputs.input_status.has("look_up_down")&&(o.woop.player.look_vertical-=1),o.woop.inputs.input_status.has("look_down_down")&&(o.woop.player.look_vertical+=1)),o.woop.player.look_vertical=x.angle_range(o.woop.player.look_vertical,-90,90,!1),o.woop.inputs.input_status.has("forward_down")&&!o.woop.inputs.input_status.has("look_up_down")&&(o.woop.player.position.x+=t,o.woop.player.position.y+=e),o.woop.inputs.input_status.has("backward_down")&&!o.woop.inputs.input_status.has("look_down_down")&&(o.woop.player.position.x-=t,o.woop.player.position.y-=e),o.woop.inputs.input_status.has("strafe_right_down")&&!o.woop.inputs.input_status.has("look_right_down")&&(o.woop.player.position.x+=e,o.woop.player.position.y-=t),o.woop.inputs.input_status.has("strafe_left_down")&&!o.woop.inputs.input_status.has("look_left_down")&&(o.woop.player.position.x-=e,o.woop.player.position.y+=t),o.woop.inputs.input_status.has("up_down")&&(o.woop.player.position.z+=4),o.woop.inputs.input_status.has("down_down")&&(o.woop.player.position.z-=4)})),xe(this,"render",(function(e){e.draw_background(),o.woop.level&&e.draw_game_sector_in_field_of_view()})),this.woop=t}));function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function je(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Me(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==Me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Me(i)?i:String(i)),n)}var i}var Te=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.woop=t,this.grid_pos=t.level.boundary[0].clone(),this.grid_zoom=13,this.unit_pixel_size=.016,this.unit_by_ceil=100,this.cursor={state:0,position:new p(this.woop.renderer.canvas.width/2,this.woop.renderer.canvas.height/2)},this.grid_pos.set_x(this.grid_pos.x-200),this.grid_pos.set_y(this.grid_pos.y+200)}var t,o;return t=e,(o=[{key:"grid_scale",value:function(){return this.unit_pixel_size*this.grid_zoom}},{key:"ceil_pixel_size",value:function(){return this.unit_pixel_size*this.unit_by_ceil*this.grid_zoom}},{key:"update",value:function(){if(this.cursor.position.set_x(x.value_range(this.cursor.position.x+this.woop.inputs.mouse_movements.x,0,this.woop.renderer.canvas.width)),this.cursor.position.set_y(x.value_range(this.cursor.position.y+this.woop.inputs.mouse_movements.y,0,this.woop.renderer.canvas.height)),this.grid_zoom=x.value_range(this.grid_zoom-this.woop.inputs.mouse_movements.wheel/100,5,40),this.woop.inputs.input_status.has("editor_grab_down")?(this.cursor.state=1,this.grid_pos.set_x(this.grid_pos.x-this.woop.inputs.mouse_movements.x/this.unit_pixel_size/this.grid_zoom),this.grid_pos.set_y(this.grid_pos.y+this.woop.inputs.mouse_movements.y/this.unit_pixel_size/this.grid_zoom)):this.cursor.state=0,this.woop.debbuger.enable){this.woop.inputs.input_status.has("look_left_down")&&(this.woop.player.horizontal_angle+=2),this.woop.inputs.input_status.has("look_right_down")&&(this.woop.player.horizontal_angle-=2),this.woop.player.horizontal_angle=x.angle_range(this.woop.player.horizontal_angle);var e=Math.round(6*x.lookup_sin(this.woop.player.horizontal_angle)),t=Math.round(6*x.lookup_cos(this.woop.player.horizontal_angle));this.woop.inputs.input_status.has("forward_down")&&!this.woop.inputs.input_status.has("look_up_down")&&(this.woop.player.position.x+=t,this.woop.player.position.y+=e),this.woop.inputs.input_status.has("backward_down")&&!this.woop.inputs.input_status.has("look_down_down")&&(this.woop.player.position.x-=t,this.woop.player.position.y-=e),this.woop.inputs.input_status.has("strafe_right_down")&&!this.woop.inputs.input_status.has("look_right_down")&&(this.woop.player.position.x+=e,this.woop.player.position.y-=t),this.woop.inputs.input_status.has("strafe_left_down")&&!this.woop.inputs.input_status.has("look_left_down")&&(this.woop.player.position.x-=e,this.woop.player.position.y+=t)}}},{key:"render",value:function(e){e.draw_background("black"),e.update_render_variables("editor",{grid_scale:this.grid_scale(),pixel_x_offset:this.grid_pos.x*this.unit_pixel_size*this.grid_zoom,pixel_y_offset:-1*this.grid_pos.y*this.unit_pixel_size*this.grid_zoom}),e.draw_editor_grid(),this.woop.level&&(e.draw_editor_box(this.woop.level.boundary[0].x,this.woop.level.boundary[0].y,this.woop.level.boundary[1].x,this.woop.level.boundary[1].y),this.woop.level.vertices.forEach((function(t){e.draw_editor_point(t.x,t.y)})),this.woop.level.segments.forEach((function(t){e.draw_editor_line(t.vertices[0].x,t.vertices[0].y,t.vertices[1].x,t.vertices[1].y)})),e.draw_editor_sector_in_field_of_view()),this.woop.player&&e.draw_editor_player(),this.woop.inputs.mouse_lock&&e.draw_cursor(this.cursor.position.x,this.cursor.position.y,this.cursor.state)}}])&&je(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function Ee(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Pe(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Pe(i)?i:String(i)),n)}var i}var ze=function(){function e(t){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.woop=t,this.enable=o,this.is_init=!1,this.head=null,this.body=null,this.map_context=null}var t,o;return t=e,(o=[{key:"init",value:function(){var e=this,t=document.createElement("pre"),o=document.createElement("pre"),n=Math.min(200/this.woop.level.size.x,200/this.woop.level.size.y),i=Math.round(this.woop.level.size.x*n),r=Math.round(this.woop.level.size.y*n);t.id="debug_head",t.style.position="absolute",t.style.display="block",t.style.top="50px",t.style.right="50px",t.style.width="216px",t.style.height="16px",t.style.backgroundColor="#850000",t.style.color="#ffffff",t.style.margin="0px",t.style.padding="2px",t.innerHTML+="Debugger <span style='float:right' id='debug_frame_rate'></span><br>",o.id="debug_body",o.style.position="absolute",o.style.display="none",o.style.top="70px",o.style.right="50px",o.style.width="200px",o.style.backgroundColor="#ffffffaa",o.style.margin="0px",o.style.padding="10px",o.innerHTML+="Fps : <span id='debug_frame_rate2'></span><br>",o.innerHTML+="Game state : <span id='debug_game_state'></span><br>",o.innerHTML+="viewport resolution : <span id='debug_vp_res'></span><br>",o.innerHTML+="Internal resolution : <span id='debug_int_res'></span><br>",o.innerHTML+="Pixel scale : <span id='debug_p_scale'></span><br>",o.innerHTML+="Keys press : <span id='debug_keys'></span><br>",o.innerHTML+="Mouse position : <span id='debug_mouse'></span><br>",o.innerHTML+="Cursor position : <span id='debug_cursor'></span><br>",o.innerHTML+="Editor position : <span id='debug_editor_pos'></span><br>",o.innerHTML+="<canvas id='debug_map' width='"+i+"' height='"+r+"'></canvas>",o.innerHTML+="Player position : <br><span id='debug_p_pos'></span><br><span id='debug_p_ang'></span><br>",document.body.append(t),document.body.append(o),this.head=t,this.body=o,this.map_context=document.getElementById("debug_map").getContext("2d"),this.map_context.fillStyle="rgba( 0, 0, 0 , 1 )",this.map_context.strokeStyle="rgba( 0, 0, 0 , 1 )",this.map_context.strokeRect(0,0,i,r),this.head.addEventListener("click",(function(){e.body.display="block"===e.body.display?"none":"block",e.body.style.setProperty("display",e.body.display)})),this.is_init=!0}},{key:"switch",value:function(){this.enable=!this.enable,this.enable||(this.body.remove(),this.body=null,this.is_init=!1)}},{key:"update",value:function(){this.enable&&(this.is_init||this.init(),document.getElementById("debug_game_state").innerHTML=this.woop.game_state,document.getElementById("debug_vp_res").innerHTML="<br>y-"+this.woop.renderer.canvas.width+" x-"+this.woop.renderer.canvas.height,document.getElementById("debug_int_res").innerHTML="<br>y-"+this.woop.renderer.internal_width+" x-"+this.woop.renderer.internal_height,document.getElementById("debug_frame_rate").innerHTML=this.woop.time.last_frame_count,document.getElementById("debug_frame_rate2").innerHTML=this.woop.time.last_frame_count,document.getElementById("debug_keys").innerHTML="<br>"+JSON.stringify(Array.from(this.woop.inputs.input_status).join(" ,<br>")),document.getElementById("debug_mouse").innerHTML="<br>mouse "+(this.woop.inputs.mouse_lock?"lock ":"unlock ")+"x-"+this.woop.inputs.mouse_movements.x+" y-"+this.woop.inputs.mouse_movements.y,document.getElementById("debug_cursor").innerHTML="<br>x-"+this.woop.editor.cursor.position.x+" <br>y-"+this.woop.editor.cursor.position.y,document.getElementById("debug_editor_pos").innerHTML="<br>x-"+this.woop.editor.grid_pos.x+" <br>y-"+this.woop.editor.grid_pos.y,document.getElementById("debug_p_pos").innerHTML="<br>x-"+this.woop.player.position.x+" <br>y-"+this.woop.player.position.y+" <br>z-"+this.woop.player.position.z,document.getElementById("debug_p_ang").innerHTML="h_angle-"+this.woop.player.horizontal_angle+" v_angle-"+this.woop.player.look_vertical)}},{key:"render",value:function(){if(this.enable){this.is_init||this.init();var e=Math.min(200/this.woop.level.size.x,200/this.woop.level.size.y),t=Math.round(this.woop.level.size.x*e),o=Math.round(this.woop.level.size.y*e),n=Math.round(this.woop.player.position.x/this.woop.level.size.x*t),i=Math.round((this.woop.level.size.y-this.woop.player.position.y)/this.woop.level.size.y*o),r=x.angle_range(this.woop.player.horizontal_angle-90),s=Math.round(n+10*x.lookup_cos[r]),a=Math.round(i+10*x.lookup_sin[r]);this.map_context.fillStyle="rgba( 0, 0, 0 , 0)",this.map_context.strokeStyle="rgba( 0, 0, 0 , 1)",this.map_context.clearRect(1,1,t-2,o-2),this.map_context.strokeRect(0,0,t,o),this.map_context.beginPath(),this.map_context.fillStyle="rgba( 245, 40, 145 , 1)",this.map_context.arc(n,i,2,0,2*Math.PI,!1),this.map_context.fill(),this.map_context.fillStyle="rgba( 0, 0, 0 , 0 )",this.map_context.strokeStyle="rgba( 40, 40, 40 , 1 )",this.map_context.beginPath(),this.map_context.moveTo(n,i),this.map_context.lineTo(s,a),this.map_context.stroke()}}}])&&Ee(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function Oe(){Oe=function(){return e};var e={},t=Object.prototype,o=t.hasOwnProperty,n=Object.defineProperty||function(e,t,o){e[t]=o.value},i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,o){return e[t]=o}}function u(e,t,o,i){var r=t&&t.prototype instanceof h?t:h,s=Object.create(r.prototype),a=new M(i||[]);return n(s,"_invoke",{value:w(e,o,a)}),s}function c(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var _={};function h(){}function d(){}function p(){}var f={};l(f,r,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(j([])));g&&g!==t&&o.call(g,r)&&(f=g);var v=p.prototype=h.prototype=Object.create(f);function m(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function i(n,r,s,a){var l=c(e[n],e,r);if("throw"!==l.type){var u=l.arg,_=u.value;return _&&"object"==Le(_)&&o.call(_,"__await")?t.resolve(_.__await).then((function(e){i("next",e,s,a)}),(function(e){i("throw",e,s,a)})):t.resolve(_).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,a)}))}a(l.arg)}var r;n(this,"_invoke",{value:function(e,o){function n(){return new t((function(t,n){i(e,o,t,n)}))}return r=r?r.then(n,n):n()}})}function w(e,t,o){var n="suspendedStart";return function(i,r){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw r;return{value:void 0,done:!0}}for(o.method=i,o.arg=r;;){var s=o.delegate;if(s){var a=x(s,o);if(a){if(a===_)continue;return a}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===n)throw n="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);n="executing";var l=c(e,t,o);if("normal"===l.type){if(n=o.done?"completed":"suspendedYield",l.arg===_)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(n="completed",o.method="throw",o.arg=l.arg)}}}function x(e,t){var o=t.method,n=e.iterator[o];if(void 0===n)return t.delegate=null,"throw"===o&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==o&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+o+"' method")),_;var i=c(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,_;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,_):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function j(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return d.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:d,configurable:!0}),d.displayName=l(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},m(b.prototype),l(b.prototype,s,(function(){return this})),e.AsyncIterator=b,e.async=function(t,o,n,i,r){void 0===r&&(r=Promise);var s=new b(u(t,o,n,i),r);return e.isGeneratorFunction(o)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},m(v),l(v,a,"Generator"),l(v,r,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),o=[];for(var n in t)o.push(n);return o.reverse(),function e(){for(;o.length;){var n=o.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=j,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(o,n){return s.type="throw",s.arg=e,t.next=o,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var a=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(a&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,_):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),S(o),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var n=o.completion;if("throw"===n.type){var i=n.arg;S(o)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:j(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),_}},e}function De(e,t,o,n,i,r,s){try{var a=e[r](s),l=a.value}catch(e){return void o(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function Ae(e){return function(){var t=this,o=arguments;return new Promise((function(n,i){var r=e.apply(t,o);function s(e){De(r,n,i,s,a,"next",e)}function a(e){De(r,n,i,s,a,"throw",e)}s(void 0)}))}}function Ce(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==Le(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Le(i)?i:String(i)),n)}var i}var Ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.woop=t,this.mouse_lock=!1,this.input_status=new Set,this.keys_press={keys_up:new Set,keys_down:new Set},this.mouse_press={buttons_up:new Set,buttons_down:new Set},this.mouse_movements={x:0,y:0,wheel:0},this.keys_map={editor_mode:[9],game_mode:[9],escape:[27],enter:[13],forward:[87],backward:[83],strafe_left:[65],strafe_right:[68],look_left:[16,65],look_right:[16,68],look_up:[16,87],look_down:[16,83],up:[81],down:[69]},this.mouse_buttons_map={editor_grab:[0],mouse_middle:[1],mouse_right:[2],mouse_page_down:[3],mouse_page_up:[4]},this.init_input_listener()}var t,o;return t=e,(o=[{key:"resolve_keys",value:function(){var e=this;Object.keys(this.keys_map).forEach((function(t){var o=!0,n=!0;e.keys_map[t].forEach((function(t){e.keys_press.keys_down.has(t)||(o=!1)})),e.keys_map[t].forEach((function(t){e.keys_press.keys_up.has(t)||(n=!1)})),o?e.input_status.add(t+"_down"):e.input_status.delete(t+"_down"),n?e.input_status.add(t+"_release"):e.input_status.delete(t+"_release")})),Object.keys(this.mouse_buttons_map).forEach((function(t){var o=!0,n=!0;e.mouse_buttons_map[t].forEach((function(t){e.mouse_press.buttons_down.has(t)||(o=!1)})),e.mouse_buttons_map[t].forEach((function(t){e.mouse_press.buttons_up.has(t)||(n=!1)})),o?e.input_status.add(t+"_down"):e.input_status.delete(t+"_down"),n?e.input_status.add(t+"_release"):e.input_status.delete(t+"_release")})),this.keys_press.keys_up.clear(),this.mouse_press.buttons_up.clear()}},{key:"clear_mouse_movements",value:function(){this.mouse_movements.x=0,this.mouse_movements.y=0,this.mouse_movements.wheel=0}},{key:"update_mouse_movements",value:function(e,t){e.mouse_movements.x+=.5*t.movementX,e.mouse_movements.y+=.5*t.movementY}},{key:"update_mouse_wheel",value:function(e,t){e.mouse_movements.wheel+=t.deltaY}},{key:"update_key_up",value:function(e,t){t.preventDefault(),e.keys_press.keys_up.add(t.keyCode),e.keys_press.keys_down.delete(t.keyCode)}},{key:"update_key_down",value:function(e,t){t.preventDefault(),e.keys_press.keys_down.add(t.keyCode),e.keys_press.keys_up.delete(t.keyCode)}},{key:"update_mouse_click_up",value:function(e,t){e.mouse_press.buttons_up.add(t.button),e.mouse_press.buttons_down.delete(t.button)}},{key:"update_mouse_click_down",value:function(e,t){e.mouse_press.buttons_up.delete(t.button),e.mouse_press.buttons_down.add(t.button)}},{key:"init_input_listener",value:function(){var e=this;window.addEventListener("keyup",(function(t){e.update_key_up(e,t)}),!0),window.addEventListener("keydown",(function(t){e.update_key_down(e,t)}),!0),document.addEventListener("pointerlockchange",(function(){document.pointerLockElement?(e.mouse_lock=!0,document.addEventListener("mousemove",(function(t){e.update_mouse_movements(e,t)}),!0),document.addEventListener("wheel",(function(t){e.update_mouse_wheel(e,t)}),!0),document.addEventListener("mouseup",(function(t){e.update_mouse_click_up(e,t)}),!0),document.addEventListener("mousedown",(function(t){e.update_mouse_click_down(e,t)}),!0)):(e.mouse_lock=!1,document.removeEventListener("mousemove",e.update_mouse_movements),document.removeEventListener("wheel",e.update_mouse_wheel),document.removeEventListener("mouseup",e.update_mouse_click_up),document.removeEventListener("mousedown",e.update_mouse_click_down))})),this.woop.renderer.canvas.addEventListener("click",Ae(Oe().mark((function t(){return Oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(document.pointerLockElement){t.next=3;break}return t.next=3,e.woop.renderer.canvas.requestPointerLock({unadjustedMovement:!0});case 3:case"end":return t.stop()}}),t)}))),!1)}}])&&Ce(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Re(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Be(n.key),n)}}function We(e,t,o){return(t=Be(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Be(e){var t=function(e,t){if("object"!==He(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===He(t)?t:String(t)}var Ge=function(){function e(t){var o=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),We(this,"woop_loop",(function(){for(var e=1/o.time.target_frame_rate-.005,t=performance.now()/1e3-o.time.unscaledTime,n=Math.floor(performance.now()/1e3);t>=e;){o.time.unscaledDeltaTime=performance.now()/1e3-o.time.unscaledTime,o.time.unscaledTime+=o.time.unscaledDeltaTime;var i=o.time.unscaledDeltaTime;i>o.time.maximumDeltaTime&&(i=o.time.maximumDeltaTime),o.time.deltaTime=i*o.time.timeScale,o.time.time+=o.time.deltaTime,o.update(),o.debbuger.update(),t-=e}o.render(),o.debbuger.render(),o.time.frame_count++,o.time.last_second<n&&(o.time.last_second=n,o.time.last_frame_count=o.time.frame_count,o.time.frame_count=0),requestAnimationFrame((function(){o.woop_loop()}))})),We(this,"update",(function(){switch(o.inputs.resolve_keys(),o.game_state){case 1:o.inputs.input_status.has("editor_mode_release")&&(o.game_state=2);break;case 2:o.inputs.input_status.has("game_mode_release")&&(o.game_state=1)}switch(o.game_state){case 1:o.game.update();break;case 2:o.editor.update()}o.inputs.clear_mouse_movements()})),We(this,"render",(function(){switch(o.game_state){case 1:o.game.render(o.renderer);break;case 2:o.editor.render(o.renderer)}})),void 0!==n.render&&n.render;var i=void 0!==n.scale?n.scale:4,r=void 0!==n.field_of_view?n.field_of_view:90,s=void 0!==n.frame_rate?n.frame_rate:30,a=void 0!==n.debug&&n.debug;this.renderer=new ve(this,t,r,i,s),this.game_state=2,this.debbuger=new ze(this,a),this.wad_loader=new U(this,["./wads/DOOM1.WAD"]),this.level=new K,this.level.load_from_wad(this.wad_loader,"E1M1"),this.player=this.level.spawn_player(),this.inputs=new Ie(this),this.game=new Se(this),this.editor=new Te(this),this.time={target_frame_rate:s,execution_start:window.performance.now(),unscaledTime:0,unscaledDeltaTime:0,timeScale:1,time:0,deltaTime:0,maximumDeltaTime:.3333333,frame_count:0,last_frame_count:0,last_second:0}}var t,o;return t=e,(o=[{key:"run",value:function(){this.woop_loop()}}])&&Re(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ne=t.Z;export{Ne as default};